{% extends "boilerplate.html" %}
{% block content %}
<div class="card col-md-6 offset-md-3 col-10 offset-1">
    <div class="card-body">
        <form action="./settings" class="needs-validation" method="post" novalidate>
            <h5 class="card-title">Profile</h5>
            <div class="mt-3">
                <label for="color" class="form-label">Avatar Color</label>
                <span class="avatar me-2" id="avatar"
                    style="background-color:hsl({{current_user.get_color()}},50%,50%)">{{current_user.get_name()[0].upper()}}</span>
                <strong>
                    <input type="range" class="form-range" name="color" id="color" step="1" min="0" max="360"
                        value="{{current_user.get_color()}}">
            </div>
            <label for="name" class="form-label">Name</label>
            <input type="text" class="form-control" name="name" id="name" placeholder="{{current_user.get_name()}}"
                value="{{current_user.get_name()}}" required>

            <div class="col-auto mt-3">
                <button type="submit" class="btn btn-primary">Save</button>
            </div>
        </form>
        <form action="./changepassword" class="needs-validation" method="post" novalidate>
            <h5 class="card-title mt-3">Account</h5>

            <p class="form-label">Your email is {{current_user.get_email()}}</p>

            <label for="oldpass" class="form-label">Old Password</label>
            <input type="password" class="form-control" name="oldpass" id="oldpass" required>

            <label for="newpass" class="form-label">New Password</label>
            <input type="password" class="form-control" name="newpass" id="newpass" required>

            <span>
                <label for="confirmnewpass" class="form-label">New Password</label>
                <input type="password" class="form-control" name="confirmnewpass" id="confirmnewpass" required>
                <div class="invalid-feedback">
                    Passwords do not match
                </div>
            </span>
            <div class="col-auto mt-3">
                <button type="submit" class="btn btn-primary">Change Password</button>
            </div>
        </form>
    </div>
    <script>
        let avatar = document.querySelector("#avatar");
        let colorslider = document.querySelector("#color")
        colorslider.addEventListener("input", () => {
            let val = colorslider.value
            avatar.style.backgroundColor = `hsl(${colorslider.value}, 50%, 50%)`;
        })
    </script>
</div>
{% include "formvalidate.html" %}
{% endblock %}